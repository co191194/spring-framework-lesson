# **4. ビルドツール**

ビルドツールとは、**ソースコードのコンパイル、テスト、パッケージ化、依存関係の管理**などを自動化するためのツールです。
手動で行うと手間がかかる作業を簡単にしてくれます。

## **ビルドツールで自動化できる主な作業**

Javaのビルドツールでは以下のようなことが自動化できます。

1. ソースコードのコンパイル
   - Javaファイル(.java)をコンパイルして、クラスファイル(.class)を自動生成します。
1. 依存ライブラリのダウンロード・管理
   - 必要な外部ライブラリ(例:Log4j, JUnitなど)を自動で探してダウンロードし、プロジェクトに組み込みます。
1. テストの自動実行
   - テストコード(例:JUnitテスト)を自動的に実行し、結果をレポートして出力します。
1. パッケージ化
   - 完成したプログラムをJARファイルやWARファイルにまとめます。配布やサーバのデプロイが簡単になります。
1. クリーン処理
   - 古いクラスファイルや生成物を自動で削除して、きれいな状態からビルドしなおすことができます。
1. コードの整形や静的解析
   - コードフォーマッターやLintツール、静的解析ツール(例:Checkstyle, PMD)を組み込んで自動実行できます。
1. ドキュメント生成
   - Javadocを使って、ソースコードから自動的にAPIドキュメントを生成します。
1. デプロイ作業
   - サーバへの自動デプロイや配布用リポジトリへのアップロードも自動化できます。

### **ソースコードのコンパイルでのサンプル**

#### **ビルドツールを使わない場合**

ビルドツールを使わない場合は以下のような手順となります。

1. コンパイルコマンドを実行する。
1. クラスパス(外部ライブラリなど)を自分で設定する必要がある
1. 複数のファイルがある場合、全部指定するかワイルドカードを使う

例えば、`Hello.java`というファイルをコンパイルする場合

```bash
javac Hello.java
```

外部ライブラリ(例:`lib/some-library.jar`)が必要な場合

```bash
java -cp lib/some-library.jar Hello.java
```

複数のファイルがある場合

```bash
javac -cp lib/some-library.jar src/*.java
```

#### **ビルドツールを使う場合(Mavenの場合)**

Mavenを使う場合以下のような手順になります。

1. `pom.xml`に依存ライブラリやプロジェクト情報を書く
1. Mavenのコンパイルコマンドを実行する

```bash
mvn compile
```

`pom.xml`での設定を正しく行えば、上記のコマンド1つで依存関係のダウンロード&すべてのJavaファイルのコンパイルができます。

#### **ビルドツールの有無のまとめ**

|              |  ビルドツールなし   |   ビルドツールあり    |
| ------------ | :-----------------: | :-------------------: |
| コマンド     | `javac`で自分で指定 | `mvn compile`など簡単 |
| 依存管理     |        手動         |         自動          |
| 複数ファイル |       手作業        |         自動          |
| 再現性       | 人によってバラバラ  |    みんな同じ環境     |

## **Javaにおける主なビルドツール**

### **Maven(メイヴン)**

- **特徴**: 一番有名なビルドツール。プロジェクトの構成や依存ライブラリの管理が得意。
- **設定ファイル**: `pom.xml`
- **コマンド例**:
  ```bash
  mvn compile  # コンパイル
  mvn test     # テスト
  mvn package  # パッケージ化(jar作成など)
  ```
- **メリット**: 多くのプロジェクトで使われている。依存関係の自動ダウンロードが便利。

### **Gradle(グレードル)**

- **特徴**: 新しいビルドツール。シンプルで高速、カスタマイズ性が高い。
- **設定ファイル**: `build.gradle`
- **コマンド例**:
  ```bash
  gradle build  # ビルド
  gradle test   # テスト
  ```
- **メリット**: 記述がシンプルで、複雑な処理も書きやすい。

### **Ant(アント)**

- **特徴**: 昔からあるビルドツール。細かい制御ができるが、設定がやや複雑。
- **設定ファイル**: `build.xml`
- **コマンド例**:
  ```bash
  ant         # ビルド
  ```
- **メリット**: 柔軟にカスタマイズできる。

## **どれを使えばよいのか？**

MavenかGradleがオススメです。

- Mavenは一番使われているため、情報が多くあり導入しやすい。
- Gradleは新しいプロジェクト(特にAndroid開発など)ではよく採用されているため、
  Mavenと同様に情報が多くあります。